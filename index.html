<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>My Money Manager</title>
    <link rel="manifest" href="manifest.json"> <!-- PWA Manifest Link -->
    <link rel="stylesheet" href="style.css"> <!-- CSS File Link -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"> <!-- Font Awesome for icons -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script> <!-- SheetJS for Excel export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script> <!-- jsPDF for PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script> <!-- html2canvas for capturing HTML to image -->
    <!-- Chart.js Library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>

    <!-- Lock Screen Overlay -->
    <div id="lock-screen-overlay">
        <div id="lock-screen-content">
            <div id="lock-screen-title">Money Manager</div>
            <div id="lock-screen-message">Your application has been locked due to inactivity.</div>
            <input type="password" id="lock-screen-pin-input" maxlength="4" readonly placeholder="----">
            <div id="lock-screen-error-message"></div>
            <div id="lock-screen-keyboard">
                <div class="key-row">
                    <button onclick="handleLockScreenInput('1')">1</button>
                    <button onclick="handleLockScreenInput('2')">2</button>
                    <button onclick="handleLockScreenInput('3')">3</button>
                </div>
                <div class="key-row">
                    <button onclick="handleLockScreenInput('4')">4</button>
                    <button onclick="handleLockScreenInput('5')">5</button>
                    <button onclick="handleLockScreenInput('6')">6</button>
                </div>
                <div class="key-row">
                    <button onclick="handleLockScreenInput('7')">7</button>
                    <button onclick="handleLockScreenInput('8')">8</button>
                    <button onclick="handleLockScreenInput('9')">9</button>
                </div>
                <div class="key-row">
                    <button onclick="handleLockScreenInput('0')">0</button>
                </div>
                <div class="key-row">
                    <button onclick="handleLockScreenInput('delete')" class="key-delete"><i class="fas fa-backspace"></i></button>
                </div>
            </div>
            <div id="lock-screen-footer">MKT Computer & Mobile Services</div>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <h1>My Money Manager</h1>
            <p>Your trusted companion for seamless financial tracking</p>
        </div>

        <!-- Tab Navigation -->
        <div class="tabs-container">
            <div class="tab" onclick="switchTab('opening')">Opening</div>
            <div class="tab" onclick="switchTab('transaction')">Transactions</div>
            <div class="tab" onclick="switchTab('daily-money')">Daily Money</div>
        </div>

        <div class="tabs-container-bottom">
            <div class="tab" onclick="switchTab('expense')">Expenses</div>
            <div class="tab" onclick="switchTab('debt')">Debts/Credits</div>
        </div>

       <!-- Initial View with Charts -->
        <div id="initial-charts-view" class="tab-content active"> <!-- Initially active -->
            <!-- Transaction Charts -->
            <div class="charts-container">
                <div class="chart-wrapper">
                    <h3>Transaction Type Distribution</h3>
                    <canvas id="transaction-type-chart"></canvas>
                </div>
                <div class="chart-wrapper">
                    <h3>Transaction Action Distribution</h3>
                    <canvas id="transaction-action-chart"></canvas>
                </div>
            </div>

            <!-- Daily Money Charts -->
            <div class="charts-container">
                <div class="chart-wrapper">
                    <h3>Daily Money Flow Actions</h3>
                    <canvas id="money-flow-action-chart"></canvas>
                </div>
                <div class="chart-wrapper">
                    <h3>Daily Money Flow Types</h3>
                    <canvas id="money-flow-type-chart"></canvas>
                </div>
            </div>

            <!-- Expense Charts -->
            <div class="charts-container">
                <div class="chart-wrapper">
                    <h3>Expense Category Distribution</h3>
                    <canvas id="expense-category-chart"></canvas>
                </div>
            </div>

            <!-- Debts/Credits Summary -->
            <div class="summary-section">
                <h2 onclick="toggleExpand(this.parentElement)">Debts/Credits Summary <span class="arrow"><i class="fas fa-chevron-down"></i></span></h2>
                <div class="summary-list">
                    <div class="summary-item">
                        <span class="summary-label">Total Payable:</span>
                        <span id="initial-total-payable" class="negative">0.00</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Total Receivable:</span>
                        <span id="initial-total-receivable" class="positive">0.00</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Opening Tab Content -->
        <div id="opening" class="tab-content">
            <div class="form-section">
                <h2>Set Opening Balances</h2>
                <div class="form-group">
                    <label for="opening-emoney">E-Money Balance</label>
                    <input type="text" id="opening-emoney" placeholder="Enter E-Money amount" oninput="formatInputAmount(this)">
                </div>
                <div class="form-group">
                    <label for="opening-cash">Cash Balance</label>
                    <input type="text" id="opening-cash" placeholder="Enter Cash amount" oninput="formatInputAmount(this)">
                </div>
                <button onclick="saveOpeningBalances()">Save Opening Balances</button>
            </div>

            <!-- Backup & Restore Section -->
            <div class="backup-section">
                <h2>Data Backup & Restore</h2>
                <textarea class="backup-textarea" id="backup-data" placeholder="Your backup data will appear here..."></textarea>

                <div class="button-group">
                    <button onclick="generateBackup()" class="secondary"><i class="fas fa-download"></i> Generate Backup</button>
                    <button onclick="restoreBackup()" class="secondary"><i class="fas fa-upload"></i> Restore</button>
                </div>

                <div class="button-group" style="margin-top: 15px;">
                    <button onclick="generateBackupFile()" class="secondary"><i class="fas fa-file-export"></i> Export File</button>
                    <button class="secondary" onclick="document.getElementById('backup-file-input').click()"><i class="fas fa-file-import"></i> Import File</button>
                </div>

                <input type="file" id="backup-file-input" accept=".json" style="display: none;" onchange="restoreFromFile(event)">
            </div>

            <!-- Export Data Section -->
            <div class="form-section">
                <h2>Export Your Data</h2>
                <div class="export-buttons-container">
                    <button class="export-button" onclick="exportToExcel()">
                        <i class="fas fa-file-excel"></i> Export to Excel
                    </button>
                    <button class="export-button" onclick="exportToPDF()">
                        <i class="fas fa-file-pdf"></i> Export to PDF
                    </button>
                </div>
            </div>

            <!-- Security and Appearance Settings Section -->
            <div class="form-section">
                <div id="settings-lock-section">
                    <h3>Security Settings</h3>
                    <div class="form-group">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <input type="checkbox" id="enable-screen-lock" onchange="saveLockSetting()" style="width: 18px; height: 18px;">
                            <label for="enable-screen-lock" style="margin-bottom: 0;">Enable Screen Lock</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="current-pin">Current PIN:</label>
                        <input type="password" id="current-pin" placeholder="Enter current PIN" maxlength="4">
                    </div>
                    <div class="form-group">
                        <label for="new-pin">New PIN:</label>
                        <input type="password" id="new-pin" placeholder="Enter new 4-digit PIN" maxlength="4">
                    </div>
                    <div class="form-group">
                        <label for="confirm-new-pin">Confirm New PIN:</label>
                        <input type="password" id="confirm-new-pin" placeholder="Confirm new PIN" maxlength="4">
                    </div>
                    <button onclick="handleChangePIN()">Change PIN</button>
                    <div style="margin-top: 15px; font-size: 0.8rem; color: var(--text-light);">
                        <i class="fas fa-info-circle"></i> Note: If you forget your PIN, all application data will be wiped.
                    </div>
                </div>

                <!-- Appearance Section -->
                <div id="settings-appearance-section">
                    <h3>Appearance</h3>
                    <button id="appearance-dark-mode-button" onclick="toggleDarkMode()">
                        <i class="fas fa-moon"></i> Dark Mode
                    </button>
                </div>
            </div>
        </div>

        <!-- Transaction Tab Content -->
        <div id="transaction" class="tab-content">
            <div class="card-container">
                <div class="card">
                    <h3>E-Money Balance</h3>
                    <div class="card-amount" id="e-money-balance">0.00</div>
                </div>
                <div class="card">
                    <h3>Cash Balance</h3>
                    <div class="card-amount" id="cash-balance">0.00</div>
                </div>
                <div class="card">
                    <h3>Total Balance</h3>
                    <div class="card-amount" id="total-balance">0.00</div>
                </div>
            </div>

            <div class="form-section">
                <h2>Add New Transaction</h2>
                <div class="form-group">
                    <label for="transaction-id">Transaction ID</label>
                    <input type="text" id="transaction-id" placeholder="Enter unique transaction ID">
                </div>
                <div class="form-group">
                    <label for="transaction-date">Date/Time</label>
                    <input type="datetime-local" id="transaction-date">
                </div>
                <div class="form-group">
                    <label for="transaction-type">Transaction Type</label>
                    <select id="transaction-type" onchange="updateTransactionType(); updateSavedCommissionAndFee();">
                        <option value="Wave Money">Wave Money</option>
                        <option value="Wave Pay">Wave Pay</option>
                        <option value="KBZ Pay">KBZ Pay</option>
                        <option value="Aya Pay">Aya Pay</option>
                        <option value="other">Other (Manual)</option>
                    </select>
                    <input type="text" id="transaction-type-other" style="display: none; margin-top: 10px;" placeholder="Specify other type">
                    <button type="button" class="secondary" style="width: auto; margin-top: 10px; padding: 8px 12px; font-size: 0.8rem;" onclick="removeCustomTransactionType()">Remove Custom Type</button>
                </div>
                <div class="form-group">
                    <label for="transaction-action">Action</label>
                    <select id="transaction-action" onchange="updateSavedCommissionAndFee();">
                        <option value="Cash In">Cash In</option>
                        <option value="Cash Out">Cash Out</option>
                        <option value="Send Money">Send Money</option>
                        <option value="Received Money">Received Money</option>
                        <option value="Payment">Payment</option>
                        <option value="Phone Bill">Phone Bill</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="transaction-amount">Amount</label>
                    <input type="text" id="transaction-amount" placeholder="Enter amount" oninput="updateSavedCommissionAndFee(); formatInputAmount(this);">
                </div>
                <div class="form-group">
                    <label for="transaction-commission">Commission</label>
                    <input type="text" id="transaction-commission" placeholder="Commission" oninput="saveFeeTemporarily(); formatInputAmount(this);">
                </div>
                <div class="form-group">
                    <label for="transaction-fee">Fee</label>
                    <input type="text" id="transaction-fee" placeholder="Enter fee" oninput="saveFeeTemporarily(); formatInputAmount(this);">
                </div>
                <div class="form-group phone-input">
                    <label for="transaction-phone">Phone Number</label>
                    <input type="text" id="transaction-phone" placeholder="0912345678">
                </div>
                <div class="form-group">
                    <label for="transaction-note">Note</label>
                    <input type="text" id="transaction-note" placeholder="Optional: customer name, details">
                </div>
                <div class="button-group">
                    <button type="button" onclick="addTransaction()"><i class="fas fa-plus-circle"></i> Add Transaction</button>
                    <button onclick="cancelEditTransaction()" class="secondary"><i class="fas fa-ban"></i> Cancel</button>
                </div>
            </div>

            <!-- Transaction Filters -->
            <div class="filter-section">
                <select id="transaction-filter-type">
                    <option value="all">All Types</option>
                    <option value="Wave Money">Wave Money</option>
                    <option value="Wave Pay">Wave Pay</option>
                    <option value="KBZ Pay">KBZ Pay</option>
                    <option value="Aya Pay">Aya Pay</option>
                </select>
                <select id="transaction-filter-action">
                    <option value="all">All Actions</option>
                    <option value="Cash In">Cash In</option>
                    <option value="Cash Out">Cash Out</option>
                    <option value="Send Money">Send Money</option>
                    <option value="Received Money">Received Money</option>
                    <option value="Payment">Payment</option>
                    <option value="Phone Bill">Phone Bill</option>
                </select>
                <input type="date" id="transaction-filter-date" onchange="filterTransactions()">
                <button onclick="filterTransactions()"><i class="fas fa-filter"></i> Filter</button>
                <button onclick="resetTransactionFilters()" class="secondary"><i class="fas fa-times"></i> Reset</button>
            </div>

            <!-- Transaction List -->
            <div class="transaction-list" id="transaction-list">
                <h2 onclick="toggleExpand(this.parentElement)">Transaction History <span class="arrow"><i class="fas fa-chevron-down"></i></span></h2>
                <div class="transaction-list-items">
                    <!-- Transactions will be added here dynamically -->
                </div>
            </div>

            <!-- Daily Summary for Transactions -->
            <div class="summary-section">
                <h2 onclick="updateSummariesBasedOnCurrentView(); toggleExpand(this.parentElement)">Daily Summary <span class="arrow"><i class="fas fa-chevron-down"></i></span></h2>
                <div class="summary-list">
                    <div class="summary-item">
                        <span class="summary-label">E-Money Balance (Today) [IN]:</span>
                        <span id="daily-e-money" class="positive">0.00</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Cash Balance (Today) [IN]:</span>
                        <span id="daily-cash" class="positive">0.00</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Total Commission Earned (Today):</span>
                        <span id="total-commission-summary" class="positive">0.00</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Total Fees Charged (Today):</span>
                        <span id="total-fee-summary" class="positive">0.00</span>
                    </div>
                    <div class="summary-item">
                    	<span class="summary-label">Net Balance Change (Today):</span>
                        <span id="daily-net-balance" class="positive">0.00</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Daily Money Tab Content -->
        <div id="daily-money" class="tab-content">
            <div class="form-section">
                <h2>Record Daily Money Flow</h2>
                <div class="form-group">
                    <label for="money-date">Date/Time</label>
                    <input type="datetime-local" id="money-date">
                </div>
                <div class="form-group">
                    <label for="money-amount">Amount</label>
                    <input type="text" id="money-amount" placeholder="Enter amount" oninput="calculateMoneyCommission(); formatInputAmount(this);">
                </div>
                <div class="form-group">
                    <label for="money-action">Action</label>
                    <select id="money-action" onchange="toggleCommissionField(); calculateMoneyCommission()">
                        <option value="Emoney In">E-Money In</option>
                        <option value="Emoney Out">E-Money Out</option>
                        <option value="Cash In">Cash In</option>
                        <option value="Cash Out">Cash Out</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="money-type">Type</label>
                    <select id="money-type" onchange="updateMoneyType()">
                        <option value="Wave Money">Wave Money</option>
                        <option value="KBZ Pay">KBZ Pay</option>
                        <option value="Aya Pay">Aya Pay</option>
                        <option value="other">Other (Manual)</option>
                    </select>
                    <input type="text" id="money-type-other" style="display: none; margin-top: 10px;" placeholder="Specify other type">
                    <button type="button" class="secondary" style="width: auto; margin-top: 10px; padding: 8px 12px; font-size: 0.8rem;" onclick="removeCustomMoneyType()">Remove Custom Type</button>
                </div>
                <div class="form-group" id="money-commission-group" style="display: none;">
                    <label for="money-commission">Commission (%)</label>
                    <input type="text" id="money-commission" placeholder="Enter commission percentage" oninput="calculateMoneyCommission(); formatInputAmount(this);">
                </div>
                <div class="form-group">
                    <label for="money-note">Note</label>
                    <input type="text" id="money-note" placeholder="Optional: source of funds, purpose">
                </div>
                <div class="button-group">
                    <button onclick="addMoneyRecord()"><i class="fas fa-plus-circle"></i> Add Record</button>
                    <button onclick="cancelEditMoneyRecord()" class="secondary"><i class="fas fa-ban"></i> Cancel</button>
                </div>
            </div>

            <!-- Money Record Filters -->
            <div class="filter-section">
                <select id="money-filter-action">
                    <option value="all">All Actions</option>
                    <option value="Emoney In">E-Money In</option>
                    <option value="Emoney Out">E-Money Out</option>
                    <option value="Cash In">Cash In</option>
                    <option value="Cash Out">Cash Out</option>
                </select>
                <input type="date" id="money-filter-date" onchange="filterMoneyRecords()">
                <button onclick="filterMoneyRecords()"><i class="fas fa-filter"></i> Filter</button>
                <button onclick="resetMoneyFilters()" class="secondary"><i class="fas fa-times"></i> Reset</button>
            </div>

            <!-- Money Records List -->
            <div class="transaction-list" id="money-list">
                <h2 onclick="toggleExpand(this.parentElement)">Money Records Flow <span class="arrow"><i class="fas fa-chevron-down"></i></span></h2>
                <div class="transaction-list-items">
                    <!-- Records will be added here dynamically -->
                </div>
            </div>

            <!-- Daily Summary for Money Records -->
            <div class="summary-section">
                <h2 onclick="updateSummariesBasedOnCurrentView(); toggleExpand(this.parentElement)">Daily Summary <span class="arrow"><i class="fas fa-chevron-down"></i></span></h2>
                <div class="summary-list">
                    <div class="summary-item">
                        <span class="summary-label">E-Money In:</span>
                        <span id="daily-emoney-in" class="positive">0.00</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">E-Money Out:</span>
                        <span id="daily-emoney-out" class="negative">0.00</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Cash In:</span>
                        <span id="daily-cash-in" class="positive">0.00</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Cash Out:</span>
                        <span id="daily-cash-out" class="negative">0.00</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Net Balance (Today):</span>
                        <span id="daily-remaining" class="positive">0.00</span>
                    </div>
                    <div class="summary-item" id="daily-money-commission-item" style="display: none;">
                        <span class="summary-label">Commission Earned:</span>
                        <span id="daily-money-commission" class="positive">0.00</span>
                    </div>
                    <!-- NEW: Total Amount (Today) -->
                    <div class="summary-item">
                        <span class="summary-label">Total Amount Flow (Today):</span>
                        <span id="daily-total-flow" class="positive">0.00</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- EXPENSE TAB Content -->
        <div id="expense" class="tab-content">
            <div class="form-section">
                <h2>Add New Expense/Income Entry</h2>
                <div class="form-group">
                    <label for="expense-date">Date/Time</label>
                    <input type="datetime-local" id="expense-date">
                </div>
                <div class="form-group">
                    <label for="expense-type">Type</label>
                    <select id="expense-type" onchange="updateExpenseCategoryVisibility()">
                        <option value="Expense">Expense</option>
                        <option value="Income">Income</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="expense-category">Category</label>
                    <select id="expense-category" onchange="updateExpenseCategoryVisibility()">
                        <option value="Rent">Rent</option>
                        <option value="Sales">Sales</option>
                        <option value="other">Other (Manual)</option>
                    </select>
                    <input type="text" id="expense-category-other" style="display: none; margin-top: 10px;" placeholder="Specify other category">
                    <button type="button" class="secondary" style="width: auto; margin-top: 10px; padding: 8px 12px; font-size: 0.8rem;" onclick="removeCustomExpenseCategory()">Remove Custom Category</button>
                </div>
                <div class="form-group">
                    <label for="expense-amount">Amount</label>
                    <input type="text" id="expense-amount" placeholder="Enter amount" oninput="formatInputAmount(this)">
                </div>
                <div class="form-group">
                    <label for="expense-payment-method">Payment Method</label>
                    <select id="expense-payment-method" onchange="updatePaymentMethodVisibility()">
                        <option value="E-Money">E-Money</option>
                        <option value="Cash">Cash</option>
                        <option value="Other">Other</option>
                    </select>
                    <input type="text" id="expense-payment-method-other" style="display: none; margin-top: 10px;" placeholder="Specify other method">
                    <button type="button" class="secondary" style="width: auto; margin-top: 10px; padding: 8px 12px; font-size: 0.8rem;" onclick="removeCustomPaymentMethod()">Remove Custom Method</button>
                </div>
                <div class="form-group">
                    <label for="expense-note">Note</label>
                    <input type="text" id="expense-note" placeholder="Optional: purpose of expense, source of income">
                </div>
                <div class="button-group">
                    <button type="button" onclick="addExpenseEntry()"><i class="fas fa-plus-circle"></i> Add Entry</button>
                    <button onclick="cancelEditExpenseEntry()" class="secondary"><i class="fas fa-ban"></i> Cancel</button>
                </div>
            </div>

            <!-- Expense Filters -->
            <div class="filter-section">
                <select id="expense-filter-type">
                    <option value="all">All Types</option>
                    <option value="Expense">Expense</option>
                    <option value="Income">Income</option>
                </select>
                <input type="text" id="expense-filter-category" placeholder="Filter by Category">
                <input type="date" id="expense-filter-date" onchange="filterExpenses()">
                <button onclick="filterExpenses()"><i class="fas fa-filter"></i> Filter</button>
                <button onclick="resetExpenseFilters()" class="secondary"><i class="fas fa-times"></i> Reset</button>
            </div>

            <!-- Expense/Income List -->
            <div class="transaction-list" id="expense-list">
                <h2 onclick="toggleExpand(this.parentElement)">Expense/Income Records <span class="arrow"><i class="fas fa-chevron-down"></i></span></h2>
                <div class="transaction-list-items">
                    <!-- Expense entries will be added here -->
                </div>
            </div>

            <!-- Daily Summary for Expenses -->
            <div class="summary-section">
                <h2 onclick="updateExpenseSummaries(); toggleExpand(this.parentElement)">Daily Summary <span class="arrow"><i class="fas fa-chevron-down"></i></span></h2>
                <div class="summary-list">
                    <div class="summary-item">
                        <span class="summary-label">Total Income (Today):</span>
                        <span id="daily-total-income" class="positive">0.00</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Total Expenses (Today):</span>
                        <span id="daily-total-expenses" class="negative">0.00</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Net Balance (Today):</span>
                        <span id="daily-net-balance" class="positive">0.00</span>
                    </div>
                </div>
            </div>

            <!-- Periodical Summary for Expenses -->
            <div class="summary-section">
                <h2 onclick="updatePeriodicalExpenseSummaries(); toggleExpand(this.parentElement)">Periodical Summaries <span class="arrow"><i class="fas fa-chevron-down"></i></span></h2>
                <div class="summary-list">
                    <div class="form-group">
                        <label for="period-type">Select Period:</label>
                        <select id="period-type" onchange="updatePeriodicalExpenseSummaries()">
                            <option value="week">This Week</option>
                            <option value="month">This Month</option>
                            <option value="year">This Year</option>
                        </select>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Total Income (Period):</span>
                        <span id="periodical-total-income" class="positive">0.00</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Total Expenses (Period):</span>
                        <span id="periodical-total-expenses" class="negative">0.00</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Net Balance (Period):</span>
                        <span id="periodical-net-balance" class="positive">0.00</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Debt/Credit Tab Content -->
        <div id="debt" class="tab-content">
            <div class="form-section debt-form-section">
                <h2>Add New Debt/Credit Entry</h2>
                <div class="form-group" style="position: relative;">
                    <label for="debt-name">Name</label>
                    <input type="text" id="debt-name" placeholder="Enter person's name" oninput="handleDebtNameInput(event)">
                    <!-- Suggestions Dropdown -->
                    <div id="debt-name-suggestions">
                        <!-- Suggestions will be loaded here -->
                    </div>
                </div>
                <div class="form-group">
                    <label for="debt-type">Type</label>
                    <select id="debt-type" onchange="updateDebtFormVisibility()">
                        <option value="payable">You Owe (Payable)</option>
                        <option value="receivable">Others Owe You (Receivable)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="debt-amount">Amount</label>
                    <input type="text" id="debt-amount" placeholder="Enter amount" oninput="formatInputAmount(this)">
                </div>
                <div class="form-group">
                    <label for="debt-date">Date/Time</label>
                    <input type="datetime-local" id="debt-date">
                </div>
                <div class="form-group">
                    <label for="debt-note">Note</label>
                    <input type="text" id="debt-note" placeholder="Optional: reason for debt, repayment terms">
                </div>
                <div class="button-group">
                    <button id="add-update-debt-button" onclick="addOrUpdateDebtEntry()"><i class="fas fa-save"></i> Add Debt/Credit</button>
                    <button onclick="cancelEditDebtEntry()" class="secondary"><i class="fas fa-ban"></i> Cancel</button>
                </div>
            </div>

            <!-- Debt Filter -->
            <div class="filter-section">
                <input type="text" id="debt-filter-name" placeholder="Search by Name..." style="min-width: 250px; flex-grow: 2;">
                <button onclick="filterDebts()"><i class="fas fa-search"></i> Search</button>
                <button onclick="resetDebtFilters()" class="secondary"><i class="fas fa-times"></i> Reset</button>
            </div>

            <!-- Payable Debts List -->
            <div class="transaction-list" id="payable-debts-list">
                <h2 onclick="toggleExpand(this.parentElement)">Payable Debts <span class="arrow"><i class="fas fa-chevron-down"></i></span></h2>
                <div class="transaction-list-items">
                    <!-- Payable debt items will be added here -->
                </div>
            </div>

            <!-- Receivable Credits List -->
            <div class="transaction-list" id="receivable-debts-list">
                <h2 onclick="toggleExpand(this.parentElement)">Receivable Credits <span class="arrow"><i class="fas fa-chevron-down"></i></span></h2>
                <div class="transaction-list-items">
                    <!-- Receivable debt items will be added here -->
                </div>
            </div>

            <!-- Debt/Credit Summary Totals -->
            <div class="debt-summary-totals">
                <div class="total-payable">
                    <span class="label">Total Payable:</span>
                    <span class="amount" id="total-payable-amount">0.00</span>
                </div>
                <div class="total-receivable">
                    <span class="label">Total Receivable:</span>
                    <span class="amount" id="total-receivable-amount">0.00</span>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script> <!-- JavaScript File Link -->
    <script>
        // Register Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/service-worker.js')
                .then(registration => {
                    console.log('ServiceWorker registration successful with scope:', registration.scope);
                })
                .catch(error => {
                    console.log('ServiceWorker registration failed:', error);
                });
        }
    </script>
</body>
</html>
